{"version":3,"file":"aria.js","sources":["../../../../../packages/utils/dom/aria.ts"],"sourcesContent":["const FOCUSABLE_ELEMENT_SELECTORS = `a[href],button:not([disabled]),button:not([hidden]),:not([tabindex=\"-1\"]),input:not([disabled]),input:not([type=\"hidden\"]),select:not([disabled]),textarea:not([disabled])`\n\nconst isHTMLElement = (e: unknown): e is Element => {\n  if (typeof Element === 'undefined') return false\n  return e instanceof Element\n}\n\n/**\n * Determine if the testing element is visible on screen no matter if its on the viewport or not\n */\nexport const isVisible = (element: HTMLElement) => {\n  if (process.env.NODE_ENV === 'test') return true\n  const computed = getComputedStyle(element)\n  // element.offsetParent won't work on fix positioned\n  // WARNING: potential issue here, going to need some expert advices on this issue\n  return computed.position === 'fixed' ? false : element.offsetParent !== null\n}\n\nexport const obtainAllFocusableElements = (\n  element: HTMLElement\n): HTMLElement[] => {\n  return Array.from(\n    element.querySelectorAll<HTMLElement>(FOCUSABLE_ELEMENT_SELECTORS)\n  ).filter((item: HTMLElement) => isFocusable(item) && isVisible(item))\n}\n\n/**\n * @desc Determine if target element is focusable\n * @param element {HTMLElement}\n * @returns {Boolean} true if it is focusable\n */\nexport const isFocusable = (element: HTMLElement): boolean => {\n  if (\n    element.tabIndex > 0 ||\n    (element.tabIndex === 0 && element.getAttribute('tabIndex') !== null)\n  ) {\n    return true\n  }\n  if (\n    element.tabIndex < 0 ||\n    element.hasAttribute('disabled') ||\n    element.getAttribute('aria-disabled') === 'true'\n  ) {\n    return false\n  }\n\n  switch (element.nodeName) {\n    case 'A': {\n      // casting current element to Specific HTMLElement in order to be more type precise\n      return (\n        !!(element as HTMLAnchorElement).href &&\n        (element as HTMLAnchorElement).rel !== 'ignore'\n      )\n    }\n    case 'INPUT': {\n      return !(\n        (element as HTMLInputElement).type === 'hidden' ||\n        (element as HTMLInputElement).type === 'file'\n      )\n    }\n    case 'BUTTON':\n    case 'SELECT':\n    case 'TEXTAREA': {\n      return true\n    }\n    default: {\n      return false\n    }\n  }\n}\n\n/**\n * Trigger an event\n * mouseenter, mouseleave, mouseover, keyup, change, click, etc.\n * @param  {HTMLElement} elm\n * @param  {String} name\n * @param  {*} opts\n */\nexport const triggerEvent = function (\n  elm: HTMLElement,\n  name: string,\n  ...opts: Array<boolean>\n): HTMLElement {\n  let eventName: string\n\n  if (name.includes('mouse') || name.includes('click')) {\n    eventName = 'MouseEvents'\n  } else if (name.includes('key')) {\n    eventName = 'KeyboardEvent'\n  } else {\n    eventName = 'HTMLEvents'\n  }\n  const evt = document.createEvent(eventName)\n\n  evt.initEvent(name, ...opts)\n  elm.dispatchEvent(evt)\n  return elm\n}\n\nexport const isLeaf = (el: HTMLElement) => !el.getAttribute('aria-owns')\n\nexport const getSibling = (\n  el: HTMLElement,\n  distance: number,\n  elClass: string\n) => {\n  const { parentNode } = el\n  if (!parentNode) return null\n  const siblings = parentNode.querySelectorAll(elClass)\n  const index = Array.prototype.indexOf.call(siblings, el)\n  return siblings[index + distance] || null\n}\n\nexport const focusElement = (\n  el?: HTMLElement | { focus: () => void } | null,\n  options?: FocusOptions\n) => {\n  if (!el || !el.focus) return\n  let cleanup: boolean = false\n\n  if (isHTMLElement(el) && !isFocusable(el) && !el.getAttribute('tabindex')) {\n    el.setAttribute('tabindex', '-1')\n    cleanup = true\n  }\n\n  el.focus(options)\n\n  if (isHTMLElement(el) && cleanup) {\n    el.removeAttribute('tabindex')\n  }\n}\n\nexport const focusNode = (el: HTMLElement) => {\n  if (!el) return\n  focusElement(el)\n  !isLeaf(el) && el.click()\n}\n"],"names":[],"mappings":"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"}