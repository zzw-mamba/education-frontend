{"version":3,"file":"fixed-size-list.js","sources":["../../../../../../../packages/components/virtual-list/src/components/fixed-size-list.ts"],"sourcesContent":["import { isString, throwError } from '@element-plus/utils'\nimport buildList from '../builders/build-list'\nimport { isHorizontal } from '../utils'\nimport {\n  AUTO_ALIGNMENT,\n  CENTERED_ALIGNMENT,\n  END_ALIGNMENT,\n  SMART_ALIGNMENT,\n  START_ALIGNMENT,\n} from '../defaults'\n\nimport type { VirtualizedListProps } from '../props'\n\ntype Props = VirtualizedListProps\n\nconst FixedSizeList = buildList({\n  name: 'ElFixedSizeList',\n  getItemOffset: ({ itemSize }, index) => index * (itemSize as number),\n\n  getItemSize: ({ itemSize }) => itemSize as number,\n\n  getEstimatedTotalSize: ({ total, itemSize }) => (itemSize as number) * total,\n\n  getOffset: (\n    { height, total, itemSize, layout, width },\n    index,\n    alignment,\n    scrollOffset\n  ) => {\n    const size = (isHorizontal(layout) ? width : height) as number\n    if (process.env.NODE_ENV !== 'production' && isString(size)) {\n      throwError(\n        '[ElVirtualList]',\n        `\n        You should set\n          width/height\n        to number when your layout is\n          horizontal/vertical\n      `\n      )\n    }\n    const lastItemOffset = Math.max(0, total * (itemSize as number) - size)\n    const maxOffset = Math.min(lastItemOffset, index * (itemSize as number))\n    const minOffset = Math.max(0, (index + 1) * (itemSize as number) - size)\n\n    if (alignment === SMART_ALIGNMENT) {\n      if (\n        scrollOffset >= minOffset - size &&\n        scrollOffset <= maxOffset + size\n      ) {\n        alignment = AUTO_ALIGNMENT\n      } else {\n        alignment = CENTERED_ALIGNMENT\n      }\n    }\n\n    switch (alignment) {\n      case START_ALIGNMENT: {\n        return maxOffset\n      }\n      case END_ALIGNMENT: {\n        return minOffset\n      }\n      case CENTERED_ALIGNMENT: {\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        const middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2)\n        if (middleOffset < Math.ceil(size / 2)) {\n          return 0 // near the beginning\n        } else if (middleOffset > lastItemOffset + Math.floor(size / 2)) {\n          return lastItemOffset // near the end\n        } else {\n          return middleOffset\n        }\n      }\n      case AUTO_ALIGNMENT:\n      default: {\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset\n        } else if (scrollOffset < minOffset) {\n          return minOffset\n        } else {\n          return maxOffset\n        }\n      }\n    }\n  },\n\n  getStartIndexForOffset: ({ total, itemSize }, offset) =>\n    Math.max(0, Math.min(total - 1, Math.floor(offset / (itemSize as number)))),\n\n  getStopIndexForStartIndex: (\n    { height, total, itemSize, layout, width }: Props,\n    startIndex: number,\n    scrollOffset: number\n  ) => {\n    const offset = startIndex * (itemSize as number)\n    const size = isHorizontal(layout) ? width : height\n    const numVisibleItems = Math.ceil(\n      ((size as number) + scrollOffset - offset) / (itemSize as number)\n    )\n    return Math.max(\n      0,\n      Math.min(\n        total - 1,\n        // because startIndex is inclusive, so in order to prevent array outbound indexing\n        // we need to - 1 to prevent outbound behavior\n        startIndex + numVisibleItems - 1\n      )\n    )\n  },\n\n  /**\n   * Fixed size list does not need this cache\n   * Using any to bypass it, TODO: Using type inference to fix this.\n   */\n  initCache() {\n    return undefined as any\n  },\n\n  clearCache: true,\n\n  validateProps() {},\n})\n\nexport type FixedSizeListInstance = InstanceType<typeof FixedSizeList> & unknown\nexport default FixedSizeList\n"],"names":["buildList","isHorizontal","isString","throwError","SMART_ALIGNMENT","AUTO_ALIGNMENT","CENTERED_ALIGNMENT","START_ALIGNMENT","END_ALIGNMENT"],"mappings":";;;;;;;;;;AAeA,MAAM,gBAAgBA,oBAAU,CAAA;AAAA,EAC9B,IAAM,EAAA,iBAAA;AAAA,EACN,eAAe,CAAC,EAAE,QAAS,EAAA,EAAG,UAAU,KAAS,GAAA,QAAA;AAAA,EAEjD,WAAa,EAAA,CAAC,EAAE,QAAA,EAAe,KAAA,QAAA;AAAA,EAE/B,uBAAuB,CAAC,EAAE,KAAO,EAAA,QAAA,OAAgB,QAAsB,GAAA,KAAA;AAAA,EAEvE,SAAA,EAAW,CACT,EAAE,MAAQ,EAAA,KAAA,EAAO,QAAU,EAAA,MAAA,EAAQ,KAAM,EAAA,EACzC,KACA,EAAA,SAAA,EACA,YACG,KAAA;AACH,IAAA,MAAM,IAAQ,GAAAC,kBAAA,CAAa,MAAM,CAAA,GAAI,KAAQ,GAAA,MAAA,CAAA;AAC7C,IAAA,IAAI,QAAQ,GAAI,CAAA,QAAA,KAAa,YAAgB,IAAAC,eAAA,CAAS,IAAI,CAAG,EAAA;AAC3D,MAAAC,gBAAA;AAAA,QACE,iBAAA;AAAA,QACA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAA,CAAA;AAAA,OAMF,CAAA;AAAA,KACF;AACA,IAAA,MAAM,iBAAiB,IAAK,CAAA,GAAA,CAAI,CAAG,EAAA,KAAA,GAAS,WAAsB,IAAI,CAAA,CAAA;AACtE,IAAA,MAAM,SAAY,GAAA,IAAA,CAAK,GAAI,CAAA,cAAA,EAAgB,QAAS,QAAmB,CAAA,CAAA;AACvE,IAAA,MAAM,YAAY,IAAK,CAAA,GAAA,CAAI,IAAI,KAAQ,GAAA,CAAA,IAAM,WAAsB,IAAI,CAAA,CAAA;AAEvE,IAAA,IAAI,cAAcC,wBAAiB,EAAA;AACjC,MAAA,IACE,YAAgB,IAAA,SAAA,GAAY,IAC5B,IAAA,YAAA,IAAgB,YAAY,IAC5B,EAAA;AACA,QAAY,SAAA,GAAAC,uBAAA,CAAA;AAAA,OACP,MAAA;AACL,QAAY,SAAA,GAAAC,2BAAA,CAAA;AAAA,OACd;AAAA,KACF;AAEA,IAAQ,QAAA,SAAA;AAAA,MAAA,KACDC,wBAAiB,EAAA;AACpB,QAAO,OAAA,SAAA,CAAA;AAAA,OACT;AAAA,MAAA,KACKC,sBAAe,EAAA;AAClB,QAAO,OAAA,SAAA,CAAA;AAAA,OACT;AAAA,MAAA,KACKF,2BAAoB,EAAA;AAGvB,QAAA,MAAM,eAAe,IAAK,CAAA,KAAA,CAAM,SAAa,GAAA,CAAA,SAAA,GAAY,aAAa,CAAC,CAAA,CAAA;AACvE,QAAA,IAAI,YAAe,GAAA,IAAA,CAAK,IAAK,CAAA,IAAA,GAAO,CAAC,CAAG,EAAA;AACtC,UAAO,OAAA,CAAA,CAAA;AAAA,mBACE,YAAe,GAAA,cAAA,GAAiB,KAAK,KAAM,CAAA,IAAA,GAAO,CAAC,CAAG,EAAA;AAC/D,UAAO,OAAA,cAAA,CAAA;AAAA,SACF,MAAA;AACL,UAAO,OAAA,YAAA,CAAA;AAAA,SACT;AAAA,OACF;AAAA,MACK,KAAAD,uBAAA,CAAA;AAAA,MACI,SAAA;AACP,QAAI,IAAA,YAAA,IAAgB,SAAa,IAAA,YAAA,IAAgB,SAAW,EAAA;AAC1D,UAAO,OAAA,YAAA,CAAA;AAAA,SACT,MAAA,IAAW,eAAe,SAAW,EAAA;AACnC,UAAO,OAAA,SAAA,CAAA;AAAA,SACF,MAAA;AACL,UAAO,OAAA,SAAA,CAAA;AAAA,SACT;AAAA,OACF;AAAA,KAAA;AAAA,GAEJ;AAAA,EAEA,wBAAwB,CAAC,EAAE,OAAO,QAAS,EAAA,EAAG,WAC5C,IAAK,CAAA,GAAA,CAAI,GAAG,IAAK,CAAA,GAAA,CAAI,QAAQ,CAAG,EAAA,IAAA,CAAK,MAAM,MAAU,GAAA,QAAmB,CAAC,CAAC,CAAA;AAAA,EAE5E,yBAAA,EAA2B,CACzB,EAAE,MAAQ,EAAA,KAAA,EAAO,UAAU,MAAQ,EAAA,KAAA,EACnC,EAAA,UAAA,EACA,YACG,KAAA;AACH,IAAA,MAAM,SAAS,UAAc,GAAA,QAAA,CAAA;AAC7B,IAAA,MAAM,IAAO,GAAAJ,kBAAA,CAAa,MAAM,CAAA,GAAI,KAAQ,GAAA,MAAA,CAAA;AAC5C,IAAA,MAAM,kBAAkB,IAAK,CAAA,IAAA;AAAA,MACzB,CAAA,IAAA,GAAkB,eAAe,MAAW,IAAA,QAAA;AAAA,KAChD,CAAA;AACA,IAAA,OAAO,IAAK,CAAA,GAAA;AAAA,MACV,CAAA;AAAA,MACA,IAAK,CAAA,GAAA;AAAA,QACH,KAAQ,GAAA,CAAA;AAAA,QAGR,aAAa,eAAkB,GAAA,CAAA;AAAA,OACjC;AAAA,KACF,CAAA;AAAA,GACF;AAAA,EAMA,SAAY,GAAA;AACV,IAAO,OAAA,KAAA,CAAA,CAAA;AAAA,GACT;AAAA,EAEA,UAAY,EAAA,IAAA;AAAA,EAEZ,aAAgB,GAAA;AAAA,GAAC;AACnB,CAAC;;;;"}