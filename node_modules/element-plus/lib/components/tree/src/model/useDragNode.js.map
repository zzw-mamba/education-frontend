{"version":3,"file":"useDragNode.js","sources":["../../../../../../../packages/components/tree/src/model/useDragNode.ts"],"sourcesContent":["import { provide, ref } from 'vue'\nimport { addClass, isFunction, removeClass } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\n\nimport type { InjectionKey, Ref, SetupContext } from 'vue'\nimport type {\n  AllowDragFunction,\n  AllowDropFunction,\n  FakeNode,\n  NodeDropType,\n} from '../tree.type'\nimport type TreeStore from './tree-store'\nimport type Node from './node'\nimport type { treeEmits } from '../tree'\n\nexport interface TreeNode {\n  node: Node\n  $el?: HTMLElement\n}\n\ninterface DragOptions {\n  event: DragEvent\n  treeNode: TreeNode\n}\n\ninterface Props {\n  props: {\n    allowDrag?: AllowDragFunction\n    allowDrop?: AllowDropFunction\n  }\n  ctx: SetupContext<typeof treeEmits>\n  el$: Ref<HTMLElement | null>\n  dropIndicator$: Ref<HTMLElement | null>\n  store: Ref<TreeStore>\n}\n\nexport interface DragEvents {\n  treeNodeDragStart: (options: DragOptions) => void\n  treeNodeDragOver: (options: DragOptions) => void\n  treeNodeDragEnd: (event: DragEvent) => void\n}\n\nexport const dragEventsKey: InjectionKey<DragEvents> = Symbol('dragEvents')\n\nexport function useDragNodeHandler({\n  props,\n  ctx,\n  el$,\n  dropIndicator$,\n  store,\n}: Props) {\n  const ns = useNamespace('tree')\n  const dragState = ref<{\n    allowDrop: boolean\n    dropType: NodeDropType | null\n    draggingNode: TreeNode | null\n    showDropIndicator: boolean\n    dropNode: TreeNode | null\n  }>({\n    showDropIndicator: false,\n    draggingNode: null,\n    dropNode: null,\n    allowDrop: true,\n    dropType: null,\n  })\n\n  const treeNodeDragStart = ({ event, treeNode }: DragOptions) => {\n    if (!event.dataTransfer) return\n    if (isFunction(props.allowDrag) && !props.allowDrag(treeNode.node)) {\n      event.preventDefault()\n      return false\n    }\n    event.dataTransfer.effectAllowed = 'move'\n\n    // wrap in try catch to address IE's error when first param is 'text/plain'\n    try {\n      // setData is required for draggable to work in FireFox\n      // the content has to be '' so dragging a node out of the tree won't open a new tab in FireFox\n      event.dataTransfer.setData('text/plain', '')\n    } catch {}\n    dragState.value.draggingNode = treeNode\n    ctx.emit('node-drag-start', treeNode.node, event)\n  }\n\n  const treeNodeDragOver = ({ event, treeNode }: DragOptions) => {\n    if (!event.dataTransfer) return\n    const dropNode = treeNode\n    const oldDropNode = dragState.value.dropNode\n    if (oldDropNode && oldDropNode.node.id !== dropNode.node.id) {\n      removeClass(oldDropNode.$el!, ns.is('drop-inner'))\n    }\n    const draggingNode = dragState.value.draggingNode\n    if (!draggingNode || !dropNode) return\n\n    let dropPrev = true\n    let dropInner = true\n    let dropNext = true\n    let userAllowDropInner = true\n    if (isFunction(props.allowDrop)) {\n      dropPrev = props.allowDrop(draggingNode.node, dropNode.node, 'prev')\n      userAllowDropInner = dropInner = props.allowDrop(\n        draggingNode.node,\n        dropNode.node,\n        'inner'\n      )\n      dropNext = props.allowDrop(draggingNode.node, dropNode.node, 'next')\n    }\n    event.dataTransfer.dropEffect =\n      dropInner || dropPrev || dropNext ? 'move' : 'none'\n    if (\n      (dropPrev || dropInner || dropNext) &&\n      oldDropNode?.node.id !== dropNode.node.id\n    ) {\n      if (oldDropNode) {\n        ctx.emit('node-drag-leave', draggingNode.node, oldDropNode.node, event)\n      }\n      ctx.emit('node-drag-enter', draggingNode.node, dropNode.node, event)\n    }\n\n    if (dropPrev || dropInner || dropNext) {\n      dragState.value.dropNode = dropNode\n    } else {\n      // Reset dragState.value.dropNode to null when allowDrop is transfer from true to false.(For issue #14704)\n      dragState.value.dropNode = null\n    }\n\n    if (dropNode.node.nextSibling === draggingNode.node) {\n      dropNext = false\n    }\n    if (dropNode.node.previousSibling === draggingNode.node) {\n      dropPrev = false\n    }\n    if (dropNode.node.contains(draggingNode.node, false)) {\n      dropInner = false\n    }\n    if (\n      draggingNode.node === dropNode.node ||\n      draggingNode.node.contains(dropNode.node)\n    ) {\n      dropPrev = false\n      dropInner = false\n      dropNext = false\n    }\n    const dropEl = dropNode.$el!\n\n    // find target node without children, just calc content node height\n    const targetPosition = dropEl\n      .querySelector(`.${ns.be('node', 'content')}`)!\n      .getBoundingClientRect()\n    const treePosition = el$.value!.getBoundingClientRect()\n    const treeScrollTop = el$.value!.scrollTop\n    let dropType: NodeDropType\n    const prevPercent = dropPrev\n      ? dropInner\n        ? 0.25\n        : dropNext\n          ? 0.45\n          : 1\n      : Number.NEGATIVE_INFINITY\n    const nextPercent = dropNext\n      ? dropInner\n        ? 0.75\n        : dropPrev\n          ? 0.55\n          : 0\n      : Number.POSITIVE_INFINITY\n\n    let indicatorTop = -9999\n    const distance = event.clientY - targetPosition.top\n    if (distance < targetPosition.height * prevPercent) {\n      dropType = 'before'\n    } else if (distance > targetPosition.height * nextPercent) {\n      dropType = 'after'\n    } else if (dropInner) {\n      dropType = 'inner'\n    } else {\n      dropType = 'none'\n    }\n\n    const iconPosition = dropEl\n      .querySelector(`.${ns.be('node', 'expand-icon')}`)!\n      .getBoundingClientRect()\n    const dropIndicator = dropIndicator$.value\n    if (dropType === 'before') {\n      indicatorTop = iconPosition.top - treePosition.top + treeScrollTop\n    } else if (dropType === 'after') {\n      indicatorTop = iconPosition.bottom - treePosition.top + treeScrollTop\n    }\n    dropIndicator!.style.top = `${indicatorTop}px`\n    dropIndicator!.style.left = `${iconPosition.right - treePosition.left}px`\n\n    if (dropType === 'inner') {\n      addClass(dropEl, ns.is('drop-inner'))\n    } else {\n      removeClass(dropEl, ns.is('drop-inner'))\n    }\n\n    dragState.value.showDropIndicator =\n      dropType === 'before' || dropType === 'after'\n    dragState.value.allowDrop =\n      dragState.value.showDropIndicator || userAllowDropInner\n    dragState.value.dropType = dropType\n    ctx.emit('node-drag-over', draggingNode.node, dropNode.node, event)\n  }\n\n  const treeNodeDragEnd = (event: DragEvent) => {\n    const { draggingNode, dropType, dropNode } = dragState.value\n    event.preventDefault()\n\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1911486\n    if (event.dataTransfer) {\n      event.dataTransfer.dropEffect = 'move'\n    }\n\n    if (draggingNode?.node.data && dropNode) {\n      const draggingNodeCopy: FakeNode = { data: draggingNode.node.data }\n      if (dropType !== 'none') {\n        draggingNode.node.remove()\n      }\n      if (dropType === 'before') {\n        dropNode.node.parent?.insertBefore(draggingNodeCopy, dropNode.node)\n      } else if (dropType === 'after') {\n        dropNode.node.parent?.insertAfter(draggingNodeCopy, dropNode.node)\n      } else if (dropType === 'inner') {\n        dropNode.node.insertChild(draggingNodeCopy)\n      }\n      if (dropType !== 'none') {\n        store.value.registerNode(draggingNodeCopy as any)\n        if (store.value.key) {\n          //restore checkbox state after dragging\n          draggingNode.node.eachNode((node) => {\n            store.value.nodesMap[node.data[store.value.key]]?.setChecked(\n              node.checked,\n              !store.value.checkStrictly\n            )\n          })\n        }\n      }\n\n      removeClass(dropNode.$el!, ns.is('drop-inner'))\n\n      ctx.emit(\n        'node-drag-end',\n        draggingNode.node,\n        dropNode.node,\n        dropType!,\n        event\n      )\n      if (dropType !== 'none') {\n        ctx.emit(\n          'node-drop',\n          draggingNode.node,\n          dropNode.node,\n          dropType!,\n          event\n        )\n      }\n    }\n    if (draggingNode && !dropNode) {\n      ctx.emit('node-drag-end', draggingNode.node, null, dropType!, event)\n    }\n\n    dragState.value.showDropIndicator = false\n    dragState.value.draggingNode = null\n    dragState.value.dropNode = null\n    dragState.value.allowDrop = true\n  }\n\n  provide(dragEventsKey, {\n    treeNodeDragStart,\n    treeNodeDragOver,\n    treeNodeDragEnd,\n  })\n\n  return {\n    dragState,\n  }\n}\n"],"names":["useNamespace","ref","isFunction","removeClass","addClass","_a","provide"],"mappings":"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"}