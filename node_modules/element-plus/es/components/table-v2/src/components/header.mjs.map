{"version":3,"file":"header.mjs","sources":["../../../../../../../packages/components/table-v2/src/components/header.tsx"],"sourcesContent":["import {\n  computed,\n  defineComponent,\n  inject,\n  nextTick,\n  onUpdated,\n  ref,\n  unref,\n} from 'vue'\nimport { useNamespace } from '@element-plus/hooks'\nimport { ensureArray } from '@element-plus/utils'\nimport { tableV2HeaderProps } from '../header'\nimport { enforceUnit } from '../utils'\nimport { TABLE_V2_GRID_INJECTION_KEY } from '../tokens'\n\nimport type { CSSProperties, Ref, UnwrapRef } from 'vue'\nimport type { TableV2HeaderProps } from '../header'\nimport type { UseColumnsReturn } from '../composables/use-columns'\n\nconst COMPONENT_NAME = 'ElTableV2Header'\nconst TableV2Header = defineComponent({\n  name: COMPONENT_NAME,\n  props: tableV2HeaderProps,\n  setup(props, { slots, expose }) {\n    const ns = useNamespace('table-v2')\n    const scrollLeftInfo = inject<Ref<number>>(TABLE_V2_GRID_INJECTION_KEY)\n\n    const headerRef = ref<HTMLElement>()\n\n    const headerStyle = computed(() =>\n      enforceUnit({\n        width: props.width,\n        height: props.height,\n      })\n    )\n\n    const rowStyle = computed(() =>\n      enforceUnit({\n        width: props.rowWidth,\n        height: props.height,\n      })\n    )\n\n    const headerHeights = computed(() => ensureArray(unref(props.headerHeight)))\n\n    const scrollToLeft = (left?: number) => {\n      const headerEl = unref(headerRef)\n      nextTick(() => {\n        headerEl?.scroll &&\n          headerEl.scroll({\n            left,\n          })\n      })\n    }\n\n    const renderFixedRows = () => {\n      const fixedRowClassName = ns.e('fixed-header-row')\n\n      const { columns, fixedHeaderData, rowHeight } = props\n\n      return fixedHeaderData?.map((fixedRowData, fixedRowIndex) => {\n        const style: CSSProperties = enforceUnit({\n          height: rowHeight,\n          width: '100%',\n        })\n\n        return slots.fixed?.({\n          class: fixedRowClassName,\n          columns,\n          rowData: fixedRowData,\n          rowIndex: -(fixedRowIndex + 1),\n          style,\n        })\n      })\n    }\n\n    const renderDynamicRows = () => {\n      const dynamicRowClassName = ns.e('dynamic-header-row')\n      const { columns } = props\n\n      return unref(headerHeights).map((rowHeight, rowIndex) => {\n        const style: CSSProperties = enforceUnit({\n          width: '100%',\n          height: rowHeight,\n        })\n\n        return slots.dynamic?.({\n          class: dynamicRowClassName,\n          columns,\n          headerIndex: rowIndex,\n          style,\n        })\n      })\n    }\n\n    onUpdated(() => {\n      if (scrollLeftInfo?.value) {\n        scrollToLeft(scrollLeftInfo.value)\n      }\n    })\n    expose({\n      /**\n       * @description scroll to position based on the provided value\n       */\n      scrollToLeft,\n    })\n\n    return () => {\n      if (props.height <= 0) return\n\n      return (\n        <div\n          ref={headerRef}\n          class={props.class}\n          style={unref(headerStyle)}\n          role=\"rowgroup\"\n        >\n          <div style={unref(rowStyle)} class={ns.e('header')}>\n            {renderDynamicRows()}\n            {renderFixedRows()}\n          </div>\n        </div>\n      )\n    }\n  },\n})\n\nexport default TableV2Header\n\nexport type TableV2HeaderInstance = InstanceType<typeof TableV2Header> & {\n  /**\n   * @description scroll to position based on the provided value\n   */\n  scrollToLeft: (left?: number) => void\n}\n\nexport type TableV2HeaderRendererParams = {\n  class: string\n  columns: TableV2HeaderProps['columns']\n  columnsStyles: UnwrapRef<UseColumnsReturn['columnsStyles']>\n  headerIndex: number\n  style: CSSProperties\n}\n\nexport type TableV2HeaderRowRendererParams = {\n  rowData: any\n  rowIndex: number\n} & Omit<TableV2HeaderRendererParams, 'headerIndex'>\n"],"names":["COMPONENT_NAME","TableV2Header","defineComponent","name","props","tableV2HeaderProps","setup","slots","expose","ns","useNamespace","scrollLeftInfo","inject","TABLE_V2_GRID_INJECTION_KEY","headerRef","ref","headerStyle","computed","enforceUnit","width","height","rowStyle","rowWidth","headerHeights","ensureArray","unref","headerHeight","scrollToLeft","left","headerEl","nextTick","scroll","renderFixedRows","fixedRowClassName","e","columns","fixedHeaderData","rowHeight","map","fixedRowData","fixedRowIndex","style","fixed","class","rowData","rowIndex","renderDynamicRows","dynamicRowClassName","dynamic","headerIndex","onUpdated","value","_createVNode"],"mappings":";;;;;;;AAmBA,MAAMA,cAAiB,GAAA,iBAAA,CAAA;AACvB,MAAMC,gBAAgBC,eAAgB,CAAA;AAAA,EACpCC,IAAMH,EAAAA,cAAAA;AAAAA,EACNI,KAAOC,EAAAA,kBAAAA;AAAAA,EACPC,MAAMF,KAAO,EAAA;AAAA,IAAEG,KAAAA;AAAAA,IAAOC,MAAAA;AAAAA,GAAU,EAAA;AAC9B,IAAMC,MAAAA,EAAAA,GAAKC,aAAa,UAAU,CAAA,CAAA;AAClC,IAAMC,MAAAA,cAAAA,GAAiBC,OAAoBC,2BAA2B,CAAA,CAAA;AAEtE,IAAA,MAAMC,YAAYC,GAAiB,EAAA,CAAA;AAEnC,IAAMC,MAAAA,WAAAA,GAAcC,QAAS,CAAA,MAC3BC,WAAY,CAAA;AAAA,MACVC,OAAOf,KAAMe,CAAAA,KAAAA;AAAAA,MACbC,QAAQhB,KAAMgB,CAAAA,MAAAA;AAAAA,KACf,CACH,CAAA,CAAA;AAEA,IAAMC,MAAAA,QAAAA,GAAWJ,QAAS,CAAA,MACxBC,WAAY,CAAA;AAAA,MACVC,OAAOf,KAAMkB,CAAAA,QAAAA;AAAAA,MACbF,QAAQhB,KAAMgB,CAAAA,MAAAA;AAAAA,KACf,CACH,CAAA,CAAA;AAEA,IAAMG,MAAAA,aAAAA,GAAgBN,SAAS,MAAMO,SAAAA,CAAYC,MAAMrB,KAAMsB,CAAAA,YAAY,CAAC,CAAC,CAAA,CAAA;AAE3E,IAAA,MAAMC,eAAgBC,CAAkB,IAAA,KAAA;AACtC,MAAMC,MAAAA,QAAAA,GAAWJ,MAAMX,SAAS,CAAA,CAAA;AAChCgB,MAAAA,QAAAA,CAAS,MAAM;AACbD,QAAUE,CAAAA,QAAAA,IAAAA,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,QAAAA,CAAAA,MAAAA,KACRF,SAASE,MAAO,CAAA;AAAA,UACdH,IAAAA;AAAAA,SACD,CAAA,CAAA;AAAA,OACJ,CAAA,CAAA;AAAA,KACH,CAAA;AAEA,IAAA,MAAMI,kBAAkBA,MAAM;AAC5B,MAAMC,MAAAA,iBAAAA,GAAoBxB,EAAGyB,CAAAA,CAAAA,CAAE,kBAAkB,CAAA,CAAA;AAEjD,MAAM,MAAA;AAAA,QAAEC,OAAAA;AAAAA,QAASC,eAAAA;AAAAA,QAAiBC,SAAAA;AAAAA,OAAcjC,GAAAA,KAAAA,CAAAA;AAEhD,MAAA,OAAOgC,eAAiBE,IAAAA,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,eAAAA,CAAAA,GAAAA,CAAI,CAACC,YAAAA,EAAcC,aAAkB,KAAA;AA5DnE,QAAA,IAAA,EAAA,CAAA;AA6DQ,QAAA,MAAMC,QAAuBvB,WAAY,CAAA;AAAA,UACvCE,MAAQiB,EAAAA,SAAAA;AAAAA,UACRlB,KAAO,EAAA,MAAA;AAAA,SACR,CAAA,CAAA;AAED,QAAOZ,OAAAA,CAAAA,EAAAA,GAAAA,KAAAA,CAAMmC,UAANnC,IAAc,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,KAAA,EAAA;AAAA,UACnBoC,KAAOV,EAAAA,iBAAAA;AAAAA,UACPE,OAAAA;AAAAA,UACAS,OAASL,EAAAA,YAAAA;AAAAA,UACTM,QAAAA,EAAU,EAAEL,aAAgB,GAAA,CAAA,CAAA;AAAA,UAC5BC,KAAAA;AAAAA,SACF,CAAA,CAAA;AAAA,OACF,CAAA,CAAA;AAAA,KACF,CAAA;AAEA,IAAA,MAAMK,oBAAoBA,MAAM;AAC9B,MAAMC,MAAAA,mBAAAA,GAAsBtC,EAAGyB,CAAAA,CAAAA,CAAE,oBAAoB,CAAA,CAAA;AACrD,MAAM,MAAA;AAAA,QAAEC,OAAAA;AAAAA,OAAY/B,GAAAA,KAAAA,CAAAA;AAEpB,MAAA,OAAOqB,MAAMF,aAAa,CAAA,CAAEe,GAAI,CAAA,CAACD,WAAWQ,QAAa,KAAA;AAhF/D,QAAA,IAAA,EAAA,CAAA;AAiFQ,QAAA,MAAMJ,QAAuBvB,WAAY,CAAA;AAAA,UACvCC,KAAO,EAAA,MAAA;AAAA,UACPC,MAAQiB,EAAAA,SAAAA;AAAAA,SACT,CAAA,CAAA;AAED,QAAO9B,OAAAA,CAAAA,EAAAA,GAAAA,KAAAA,CAAMyC,YAANzC,IAAgB,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,KAAA,EAAA;AAAA,UACrBoC,KAAOI,EAAAA,mBAAAA;AAAAA,UACPZ,OAAAA;AAAAA,UACAc,WAAaJ,EAAAA,QAAAA;AAAAA,UACbJ,KAAAA;AAAAA,SACF,CAAA,CAAA;AAAA,OACD,CAAA,CAAA;AAAA,KACH,CAAA;AAEAS,IAAAA,SAAAA,CAAU,MAAM;AACd,MAAA,IAAIvC,iDAAgBwC,KAAO,EAAA;AACzBxB,QAAAA,YAAAA,CAAahB,eAAewC,KAAK,CAAA,CAAA;AAAA,OACnC;AAAA,KACD,CAAA,CAAA;AACD3C,IAAO,MAAA,CAAA;AAAA,MAILmB,YAAAA;AAAAA,KACD,CAAA,CAAA;AAED,IAAA,OAAO,MAAM;AACX,MAAA,IAAIvB,MAAMgB,MAAU,IAAA,CAAA;AAAG,QAAA,OAAA;AAEvB,MAAA,OAAAgC,YAAA,KAAA,EAAA;AAAA,QAAA,KAEStC,EAAAA,SAAAA;AAAAA,QAAS,SACPV,KAAMuC,CAAAA,KAAAA;AAAAA,QAAK,OAAA,EACXlB,MAAMT,WAAW,CAAA;AAAA,QAAC,MAAA,EAAA,UAAA;AAAA,OAAA,EAAA,CAAAoC,WAAAA,CAAA,KAAA,EAAA;AAAA,QAAA,OAAA,EAGb3B,MAAMJ,QAAQ,CAAA;AAAA,QAAC,OAAA,EAASZ,EAAGyB,CAAAA,CAAAA,CAAE,QAAQ,CAAA;AAAA,OAAC,EAAA,CAC/CY,iBAAkB,EAAA,EAClBd,iBAAiB,CAAA,CAAA,CAAA,CAAA,CAAA;AAAA,KAI1B,CAAA;AAAA,GACF;AACF,CAAC,CAAA,CAAA;AAED,aAAe/B,aAAAA;;;;"}