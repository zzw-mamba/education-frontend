{"version":3,"file":"virtual-tree.mjs","sources":["../../../../../../packages/components/tree-v2/src/virtual-tree.ts"],"sourcesContent":["import {\n  buildProps,\n  definePropType,\n  iconPropType,\n  isBoolean,\n  mutable,\n} from '@element-plus/utils'\n\nimport type { CheckboxValueType } from '@element-plus/components/checkbox'\nimport type { InjectionKey } from 'vue'\nimport type { TreeNodeData } from '@element-plus/components/tree/src/tree.type'\nimport type {\n  CheckedInfo,\n  FilterMethod,\n  TreeContext,\n  TreeData,\n  TreeKey,\n  TreeNode,\n  TreeOptionProps,\n} from './types'\n\n// constants\nexport const ROOT_TREE_INJECTION_KEY: InjectionKey<TreeContext> = Symbol()\nconst EMPTY_NODE = {\n  key: -1,\n  level: -1,\n  data: {},\n} as const\n\n// enums\nexport enum TreeOptionsEnum {\n  KEY = 'id',\n  LABEL = 'label',\n  CHILDREN = 'children',\n  DISABLED = 'disabled',\n  CLASS = '',\n}\n\nexport const enum SetOperationEnum {\n  ADD = 'add',\n  DELETE = 'delete',\n}\n\nconst itemSize = {\n  type: Number,\n  default: 26,\n}\n\n// props\nexport const treeProps = buildProps({\n  data: {\n    type: definePropType<TreeData>(Array),\n    default: () => mutable([] as const),\n  },\n  emptyText: {\n    type: String,\n  },\n  height: {\n    type: Number,\n    default: 200,\n  },\n  props: {\n    type: definePropType<TreeOptionProps>(Object),\n    default: () =>\n      mutable({\n        children: TreeOptionsEnum.CHILDREN,\n        label: TreeOptionsEnum.LABEL,\n        disabled: TreeOptionsEnum.DISABLED,\n        value: TreeOptionsEnum.KEY,\n        class: TreeOptionsEnum.CLASS,\n      } as const),\n  },\n  highlightCurrent: Boolean,\n  showCheckbox: Boolean,\n  defaultCheckedKeys: {\n    type: definePropType<TreeKey[]>(Array),\n    default: () => mutable([] as const),\n  },\n  // Whether checked state of a node not affects its father and\n  // child nodes when show-checkbox is true\n  checkStrictly: Boolean,\n  defaultExpandedKeys: {\n    type: definePropType<TreeKey[]>(Array),\n    default: () => mutable([] as const),\n  },\n  indent: {\n    type: Number,\n    default: 16,\n  },\n  itemSize,\n  icon: {\n    type: iconPropType,\n  },\n  expandOnClickNode: {\n    type: Boolean,\n    default: true,\n  },\n  checkOnClickNode: Boolean,\n  checkOnClickLeaf: {\n    type: Boolean,\n    default: true,\n  },\n  currentNodeKey: {\n    type: definePropType<TreeKey>([String, Number]),\n  },\n  // TODO need to optimization\n  accordion: Boolean,\n  filterMethod: {\n    type: definePropType<FilterMethod>(Function),\n  },\n  // Performance mode will increase memory usage, but scrolling will be smoother\n  perfMode: {\n    type: Boolean,\n    default: true,\n  },\n  /**\n   * @description always show scrollbar\n   */\n  scrollbarAlwaysOn: Boolean,\n} as const)\n\nexport const treeNodeProps = buildProps({\n  node: {\n    type: definePropType<TreeNode>(Object),\n    default: () => mutable(EMPTY_NODE),\n  },\n  expanded: Boolean,\n  checked: Boolean,\n  indeterminate: Boolean,\n  showCheckbox: Boolean,\n  disabled: Boolean,\n  current: Boolean,\n  hiddenExpandIcon: Boolean,\n  itemSize,\n} as const)\n\nexport const treeNodeContentProps = buildProps({\n  node: {\n    type: definePropType<TreeNode>(Object),\n    required: true,\n  },\n} as const)\n\n// emits\nexport const NODE_CLICK = 'node-click'\nexport const NODE_DROP = 'node-drop'\nexport const NODE_EXPAND = 'node-expand'\nexport const NODE_COLLAPSE = 'node-collapse'\nexport const CURRENT_CHANGE = 'current-change'\nexport const NODE_CHECK = 'check'\nexport const NODE_CHECK_CHANGE = 'check-change'\nexport const NODE_CONTEXTMENU = 'node-contextmenu'\n\nexport const treeEmits = {\n  [NODE_CLICK]: (data: TreeNodeData, node: TreeNode, e: MouseEvent) =>\n    data && node && e,\n  [NODE_DROP]: (data: TreeNodeData, node: TreeNode, e: DragEvent) =>\n    data && node && e,\n  [NODE_EXPAND]: (data: TreeNodeData, node: TreeNode) => data && node,\n  [NODE_COLLAPSE]: (data: TreeNodeData, node: TreeNode) => data && node,\n  [CURRENT_CHANGE]: (data: TreeNodeData, node: TreeNode) => data && node,\n  [NODE_CHECK]: (data: TreeNodeData, checkedInfo: CheckedInfo) =>\n    data && checkedInfo,\n  [NODE_CHECK_CHANGE]: (data: TreeNodeData, checked: boolean) =>\n    data && isBoolean(checked),\n  [NODE_CONTEXTMENU]: (evt: Event, data: TreeNodeData, node: TreeNode) =>\n    evt && data && node,\n}\n\nexport const treeNodeEmits = {\n  click: (node: TreeNode, e: MouseEvent) => !!(node && e),\n  drop: (node: TreeNode, e: DragEvent) => !!(node && e),\n  toggle: (node: TreeNode) => !!node,\n  check: (node: TreeNode, checked: CheckboxValueType) =>\n    node && isBoolean(checked),\n}\n"],"names":["TreeOptionsEnum","SetOperationEnum"],"mappings":";;;;;AAsBO,MAAM,0BAAqD,MAAO,GAAA;AACzE,MAAM,UAAa,GAAA;AAAA,EACjB,GAAK,EAAA,CAAA,CAAA;AAAA,EACL,KAAO,EAAA,CAAA,CAAA;AAAA,EACP,MAAM,EAAC;AACT,CAAA,CAAA;AAGY,IAAA,eAAA,qBAAAA,gBAAL,KAAA;AACL,EAAAA,iBAAA,KAAM,CAAA,GAAA,IAAA,CAAA;AACN,EAAAA,iBAAA,OAAQ,CAAA,GAAA,OAAA,CAAA;AACR,EAAAA,iBAAA,UAAW,CAAA,GAAA,UAAA,CAAA;AACX,EAAAA,iBAAA,UAAW,CAAA,GAAA,UAAA,CAAA;AACX,EAAAA,iBAAA,OAAQ,CAAA,GAAA,EAAA,CAAA;AALE,EAAAA,OAAAA,gBAAAA,CAAAA;AAAA,CAAA,EAAA,eAAA,IAAA,EAAA,EAAA;AAQM,IAAA,gBAAA,qBAAAC,iBAAX,KAAA;AACL,EAAAA,kBAAA,KAAM,CAAA,GAAA,KAAA,CAAA;AACN,EAAAA,kBAAA,QAAS,CAAA,GAAA,QAAA,CAAA;AAFO,EAAAA,OAAAA,iBAAAA,CAAAA;AAAA,CAAA,EAAA,gBAAA,IAAA,EAAA,EAAA;AAKlB,MAAM,QAAW,GAAA;AAAA,EACf,IAAM,EAAA,MAAA;AAAA,EACN,OAAS,EAAA,EAAA;AACX,CAAA,CAAA;AAGO,MAAM,YAAY,UAAW,CAAA;AAAA,EAClC,IAAM,EAAA;AAAA,IACJ,IAAA,EAAM,eAAyB,KAAK,CAAA;AAAA,IACpC,OAAS,EAAA,MAAM,OAAQ,CAAA,EAAW,CAAA;AAAA,GACpC;AAAA,EACA,SAAW,EAAA;AAAA,IACT,IAAM,EAAA,MAAA;AAAA,GACR;AAAA,EACA,MAAQ,EAAA;AAAA,IACN,IAAM,EAAA,MAAA;AAAA,IACN,OAAS,EAAA,GAAA;AAAA,GACX;AAAA,EACA,KAAO,EAAA;AAAA,IACL,IAAA,EAAM,eAAgC,MAAM,CAAA;AAAA,IAC5C,OAAA,EAAS,MACP,OAAQ,CAAA;AAAA,MACN,QAAU,EAAA,UAAA;AAAA,MACV,KAAO,EAAA,OAAA;AAAA,MACP,QAAU,EAAA,UAAA;AAAA,MACV,KAAO,EAAA,IAAA;AAAA,MACP,KAAO,EAAA,EAAA;AAAA,KACC,CAAA;AAAA,GACd;AAAA,EACA,gBAAkB,EAAA,OAAA;AAAA,EAClB,YAAc,EAAA,OAAA;AAAA,EACd,kBAAoB,EAAA;AAAA,IAClB,IAAA,EAAM,eAA0B,KAAK,CAAA;AAAA,IACrC,OAAS,EAAA,MAAM,OAAQ,CAAA,EAAW,CAAA;AAAA,GACpC;AAAA,EAGA,aAAe,EAAA,OAAA;AAAA,EACf,mBAAqB,EAAA;AAAA,IACnB,IAAA,EAAM,eAA0B,KAAK,CAAA;AAAA,IACrC,OAAS,EAAA,MAAM,OAAQ,CAAA,EAAW,CAAA;AAAA,GACpC;AAAA,EACA,MAAQ,EAAA;AAAA,IACN,IAAM,EAAA,MAAA;AAAA,IACN,OAAS,EAAA,EAAA;AAAA,GACX;AAAA,EACA,QAAA;AAAA,EACA,IAAM,EAAA;AAAA,IACJ,IAAM,EAAA,YAAA;AAAA,GACR;AAAA,EACA,iBAAmB,EAAA;AAAA,IACjB,IAAM,EAAA,OAAA;AAAA,IACN,OAAS,EAAA,IAAA;AAAA,GACX;AAAA,EACA,gBAAkB,EAAA,OAAA;AAAA,EAClB,gBAAkB,EAAA;AAAA,IAChB,IAAM,EAAA,OAAA;AAAA,IACN,OAAS,EAAA,IAAA;AAAA,GACX;AAAA,EACA,cAAgB,EAAA;AAAA,IACd,IAAM,EAAA,cAAA,CAAwB,CAAC,MAAA,EAAQ,MAAM,CAAC,CAAA;AAAA,GAChD;AAAA,EAEA,SAAW,EAAA,OAAA;AAAA,EACX,YAAc,EAAA;AAAA,IACZ,IAAA,EAAM,eAA6B,QAAQ,CAAA;AAAA,GAC7C;AAAA,EAEA,QAAU,EAAA;AAAA,IACR,IAAM,EAAA,OAAA;AAAA,IACN,OAAS,EAAA,IAAA;AAAA,GACX;AAAA,EAIA,iBAAmB,EAAA,OAAA;AACrB,CAAU,EAAA;AAEH,MAAM,gBAAgB,UAAW,CAAA;AAAA,EACtC,IAAM,EAAA;AAAA,IACJ,IAAA,EAAM,eAAyB,MAAM,CAAA;AAAA,IACrC,OAAA,EAAS,MAAM,OAAA,CAAQ,UAAU,CAAA;AAAA,GACnC;AAAA,EACA,QAAU,EAAA,OAAA;AAAA,EACV,OAAS,EAAA,OAAA;AAAA,EACT,aAAe,EAAA,OAAA;AAAA,EACf,YAAc,EAAA,OAAA;AAAA,EACd,QAAU,EAAA,OAAA;AAAA,EACV,OAAS,EAAA,OAAA;AAAA,EACT,gBAAkB,EAAA,OAAA;AAAA,EAClB,QAAA;AACF,CAAU,EAAA;AAEH,MAAM,uBAAuB,UAAW,CAAA;AAAA,EAC7C,IAAM,EAAA;AAAA,IACJ,IAAA,EAAM,eAAyB,MAAM,CAAA;AAAA,IACrC,QAAU,EAAA,IAAA;AAAA,GACZ;AACF,CAAU,EAAA;AAGH,MAAM,UAAa,GAAA,aAAA;AACnB,MAAM,SAAY,GAAA,YAAA;AAClB,MAAM,WAAc,GAAA,cAAA;AACpB,MAAM,aAAgB,GAAA,gBAAA;AACtB,MAAM,cAAiB,GAAA,iBAAA;AACvB,MAAM,UAAa,GAAA,QAAA;AACnB,MAAM,iBAAoB,GAAA,eAAA;AAC1B,MAAM,gBAAmB,GAAA,mBAAA;AAEzB,MAAM,SAAY,GAAA;AAAA,EACvB,CAAC,UAAa,GAAA,CAAC,MAAoB,IAAgB,EAAA,CAAA,KACjD,QAAQ,IAAQ,IAAA,CAAA;AAAA,EAClB,CAAC,SAAY,GAAA,CAAC,MAAoB,IAAgB,EAAA,CAAA,KAChD,QAAQ,IAAQ,IAAA,CAAA;AAAA,EAClB,CAAC,WAAA,GAAc,CAAC,IAAA,EAAoB,SAAmB,IAAQ,IAAA,IAAA;AAAA,EAC/D,CAAC,aAAA,GAAgB,CAAC,IAAA,EAAoB,SAAmB,IAAQ,IAAA,IAAA;AAAA,EACjE,CAAC,cAAA,GAAiB,CAAC,IAAA,EAAoB,SAAmB,IAAQ,IAAA,IAAA;AAAA,EAClE,CAAC,UAAA,GAAa,CAAC,IAAA,EAAoB,gBACjC,IAAQ,IAAA,WAAA;AAAA,EACV,CAAC,iBAAoB,GAAA,CAAC,MAAoB,OACxC,KAAA,IAAA,IAAQ,UAAU,OAAO,CAAA;AAAA,EAC3B,CAAC,gBAAmB,GAAA,CAAC,KAAY,IAAoB,EAAA,IAAA,KACnD,OAAO,IAAQ,IAAA,IAAA;AACnB,EAAA;AAEO,MAAM,aAAgB,GAAA;AAAA,EAC3B,OAAO,CAAC,IAAA,EAAgB,CAAkB,KAAA,CAAC,EAAE,IAAQ,IAAA,CAAA,CAAA;AAAA,EACrD,MAAM,CAAC,IAAA,EAAgB,CAAiB,KAAA,CAAC,EAAE,IAAQ,IAAA,CAAA,CAAA;AAAA,EACnD,MAAQ,EAAA,CAAC,IAAmB,KAAA,CAAC,CAAC,IAAA;AAAA,EAC9B,OAAO,CAAC,IAAA,EAAgB,OACtB,KAAA,IAAA,IAAQ,UAAU,OAAO,CAAA;AAC7B;;;;"}