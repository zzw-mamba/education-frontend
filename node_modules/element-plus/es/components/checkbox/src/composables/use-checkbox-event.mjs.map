{"version":3,"file":"use-checkbox-event.mjs","sources":["../../../../../../../packages/components/checkbox/src/composables/use-checkbox-event.ts"],"sourcesContent":["import { computed, getCurrentInstance, inject, nextTick, watch } from 'vue'\nimport { useFormItem } from '@element-plus/components/form'\nimport { debugWarn } from '@element-plus/utils'\nimport { CHANGE_EVENT } from '@element-plus/constants'\nimport { checkboxGroupContextKey } from '../constants'\n\nimport type { useFormItemInputId } from '@element-plus/components/form'\nimport type { CheckboxProps } from '../checkbox'\nimport type {\n  CheckboxDisabled,\n  CheckboxModel,\n  CheckboxStatus,\n} from '../composables'\n\nexport const useCheckboxEvent = (\n  props: CheckboxProps,\n  {\n    model,\n    isLimitExceeded,\n    hasOwnLabel,\n    isDisabled,\n    isLabeledByFormItem,\n  }: Pick<CheckboxModel, 'model' | 'isLimitExceeded'> &\n    Pick<CheckboxStatus, 'hasOwnLabel'> &\n    Pick<CheckboxDisabled, 'isDisabled'> &\n    Pick<ReturnType<typeof useFormItemInputId>, 'isLabeledByFormItem'>\n) => {\n  const checkboxGroup = inject(checkboxGroupContextKey, undefined)\n  const { formItem } = useFormItem()\n  const { emit } = getCurrentInstance()!\n\n  function getLabeledValue(value: string | number | boolean) {\n    return [true, props.trueValue, props.trueLabel].includes(value)\n      ? (props.trueValue ?? props.trueLabel ?? true)\n      : (props.falseValue ?? props.falseLabel ?? false)\n  }\n\n  function emitChangeEvent(\n    checked: string | number | boolean,\n    e: InputEvent | MouseEvent\n  ) {\n    emit(CHANGE_EVENT, getLabeledValue(checked), e)\n  }\n\n  function handleChange(e: Event) {\n    if (isLimitExceeded.value) return\n\n    const target = e.target as HTMLInputElement\n    emit(CHANGE_EVENT, getLabeledValue(target.checked), e)\n  }\n\n  async function onClickRoot(e: MouseEvent) {\n    if (isLimitExceeded.value) return\n\n    if (!hasOwnLabel.value && !isDisabled.value && isLabeledByFormItem.value) {\n      // fix: https://github.com/element-plus/element-plus/issues/9981\n      const eventTargets: EventTarget[] = e.composedPath()\n      const hasLabel = eventTargets.some(\n        (item) => (item as HTMLElement).tagName === 'LABEL'\n      )\n      if (!hasLabel) {\n        model.value = getLabeledValue(\n          [false, props.falseValue, props.falseLabel].includes(model.value)\n        )\n        await nextTick()\n        emitChangeEvent(model.value, e)\n      }\n    }\n  }\n\n  const validateEvent = computed(\n    () => checkboxGroup?.validateEvent || props.validateEvent\n  )\n\n  watch(\n    () => props.modelValue,\n    () => {\n      if (validateEvent.value) {\n        formItem?.validate('change').catch((err) => debugWarn(err))\n      }\n    }\n  )\n\n  return {\n    handleChange,\n    onClickRoot,\n  }\n}\n"],"names":[],"mappings":"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"}